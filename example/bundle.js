!function t(e,i,r){function n(a,s){if(!i[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return n(i?i:t)},h,h.exports,t,e,i,r)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=[{character:"ishimaru",sprite:12,duration:500,up:[0,0,1],position:{r:5,p:.687,z:17},lookat:{r:26,p:.718,z:15.7}},{duration:600,position:{r:11.5,p:.7544,z:16.55},lookat:{r:26,p:.718,z:15.7}},{duration:2100,position:{r:12.1,p:.7544,z:16.55},lookat:{r:26,p:.718,z:15.7}},{character:"hagakure",sprite:13,duration:500,route:"circular",position:[-7.59,-8.79,16],lookat:[-10.12,-14.4,16]},{duration:2300,position:[-4.65,-10.64,16],lookat:[-7.85,-15.75,16]},{character:"togami",sprite:10,duration:500,route:"circular",position:[-13.82,-2.21,16.5],lookat:[-17.4,-4.6,16]},{duration:2300,position:[-13.82,-2.21,17],lookat:[-17.4,-4.6,17]},{character:"asahina",sprite:7,duration:500,route:"circular",position:[1,-5,14],lookat:[18,-49,16]},{duration:2300,position:[4,-10,14]},{character:"fujisaki",sprite:13,duration:500,position:[-6,-6,13],lookat:[-12,-13,13]},{duration:2300,position:[-6.33,-5.65,13],lookat:[-12.72,-12.29,13]},{character:"fujisaki",sprite:16,duration:500,position:[19.17,44,21],lookat:[-15.54,-8.46,13]},{duration:2300,fov:12,position:[16.04,45.24,21],lookat:[-13.55,-11.37,13]}],e.exports=i["default"]},{}],2:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(){function t(){var t,i,r,n,o=e.characters[Object.keys(e.characters)[Math.floor(15*Math.random())]],a=o.card.counter;screen.setDialogue(o,"I actually looked at the crime scene for more than 2 seconds, something you should try to do sometimes..."),e.mainCamera.up.x=(Math.random()-.5)/2,e.mainCamera.up.normalize(),r=.5*(Math.random()-.5),n=10*(Math.random()-.5),t=function(o){var s=(o-i)/1e4,c=2*Math.PI*(a+r*s)/16;e.mainCamera.position.set((9+n*s)*Math.cos(c),(9+n*s)*Math.sin(c),16),e.mainCamera.lookAt({x:25*Math.cos(c),y:25*Math.sin(c),z:16}),e.render(o),l["default"].step(t)},e.animation.stop(),i=window.performance.now()+5e3,l["default"].step(t)}var e=window.juicio;e.mainCamera.up.z=5,setInterval(t,1e4),t()}var o=t("promise-polyfill"),a=(r(o),t("../src/Trial.js")),s=r(a),c=t("../src/Courtroom.js"),u=r(c),h=t("../src/Animation.js"),l=r(h),f=t("./demo.debate.js"),p=r(f);window.juicio=null,window.pantalla=null,document.addEventListener("DOMContentLoaded",function(){function t(){a=!1,e.animation.stop(),document.getElementById("boton").textContent="Reiniciar",i=e.changeStage("discussion"),i.setDialogue(e.characters.naegi,"This is a very early preview test for the dangan-engine project. Press the button in the corner to start.")}var e,i,r=window.innerWidth,o=Math.floor(9/16*r);o>window.innerHeight&&(o=window.innerHeight,r=Math.floor(16/9*o)),e=new s["default"](r,o),e.scene.add(new u["default"]),[{id:"naegi",name:"Makoto Naegi"},{id:"yamada",name:"Hifumi Yamada"},{id:"fukawa",name:"Touko Fukawa"},{id:"kuwata",name:"Leon Kuwata"},{id:"celes",name:"Celestia Ludenberg"},{id:"togami",name:"Byakuya Togami"},{id:"fujisaki",name:"Chihiro Fujisaki"},{id:"hagakure",name:"Yasuhiro Hagakure"},null,{id:"asahina",name:"Aoi Asahina"},{id:"oowada",name:"Mondo Oowada"},{id:"kirigiri",name:"Kyouko Kirigiri"},{id:"oogami",name:"Sakura Oogami"},{id:"enoshima",name:"Junko Enoshima"},{id:"ishimaru",name:"Kiyotaka Ishimaru"},{id:"maizono",name:"Sayaka Maizono"}].forEach(e.setCharacter,e),e.appendCanvasTo("body").setupHUD("body");var a;document.getElementById("boton").addEventListener("click",function(){a=!a,a?(this.textContent="Detener",e.animation.tutorialToNSD().iniciarNSD(["Tsumiki’s Examination Results","Nidai’s Testimony","Mioda’s Testimony","Nanami’s Testimony","Souda’s Testimony"]).loadScript(p["default"]).delay(2e3).promise.then(t,function(e){t(),console.error(e.stack)})):t()},!1),t(),window.juicio=e,window.pantalla=i,n()},!1),window.addEventListener("gamepadconnected",function(t){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",t.gamepad.index,t.gamepad.id,t.gamepad.buttons.length,t.gamepad.axes.length),window.juicio.animation.stop(),window.juicio.gamepad=t.gamepad}),window.addEventListener("gamepaddisconnected",function(t){delete window.juicio.gamepad})},{"../src/Animation.js":4,"../src/Courtroom.js":7,"../src/Trial.js":13,"./demo.debate.js":1,"promise-polyfill":3}],3:[function(t,e,i){!function(t){function i(t,e){return function(){t.apply(e,arguments)}}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],u(t,i(o,this),i(a,this))}function n(t){var e=this;return null===this._state?void this._deferreds.push(t):void h(function(){var i=e._state?t.onFulfilled:t.onRejected;if(null===i)return void(e._state?t.resolve:t.reject)(e._value);var r;try{r=i(e._value)}catch(n){return void t.reject(n)}t.resolve(r)})}function o(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void u(i(e,t),i(o,this),i(a,this))}this._state=!0,this._value=t,s.call(this)}catch(r){a.call(this,r)}}function a(t){this._state=!1,this._value=t,s.call(this)}function s(){for(var t=0,e=this._deferreds.length;e>t;t++)n.call(this,this._deferreds[t]);this._deferreds=null}function c(t,e,i,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=i,this.reject=r}function u(t,e,i){var r=!1;try{t(function(t){r||(r=!0,e(t))},function(t){r||(r=!0,i(t))})}catch(n){if(r)return;r=!0,i(n)}}var h="function"==typeof setImmediate&&setImmediate||function(t){setTimeout(t,1)},l=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};r.prototype["catch"]=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var i=this;return new r(function(r,o){n.call(i,new c(t,e,r,o))})},r.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new r(function(e,i){function r(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){r(o,t)},i)}t[o]=a,0===--n&&e(t)}catch(c){i(c)}}if(0===t.length)return e([]);for(var n=t.length,o=0;o<t.length;o++)r(o,t[o])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,i){i(t)})},r.race=function(t){return new r(function(e,i){for(var r=0,n=t.length;n>r;r++)t[r].then(e,i)})},r._setImmediateFn=function(t){h=t},"undefined"!=typeof e&&e.exports?e.exports=r:t.Promise||(t.Promise=r)}(this)},{}],4:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("./Coordenada.js"),s=(r(a),t("./easing.js")),c=r(s),u=t("./interprete.js"),h=r(u),l=function(){function t(e){n(this,t),this.trial=e,this.promise=Promise.resolve(!0)}return o(t,[{key:"stop",value:function(){cancelAnimationFrame(t.cuadro)}},{key:"delay",value:function(t){return this.promise=this.promise.then(function(){return new Promise(function(e,i){setTimeout(e,t)})}),this}},{key:"loadScript",value:function(t){var e=this;return t.forEach(function(t){"sprite"in t&&e.changeSprite(t.character,t.sprite),e.transicion(t)}),this}},{key:"changeSprite",value:function(t,e){return this.trial.characters[t].changeSprite(e),this}},{key:"cortarHacia",value:function(e){var i=this.trial;return this.promise=this.promise.then(function(){cancelAnimationFrame(t.cuadro),"fov"in e&&(i.mainCamera.fov=e.fov,i.mainCamera.updateProjectionMatrix()),"up"in e&&i.mainCamera.up.copy(e.up),"position"in e&&i.mainCamera.position.copy(e.position),"lookat"in e&&i.mainCamera.lookAt(e.lookat.vectorThree),i.render()}),this}},{key:"transicion",value:function(e){return e.trial=this.trial,this.promise=this.promise.then(function(){var i=e.trial,r=e.duration||10,n=c["default"][e.easing]||c["default"].linear,o={};return"fov"in e&&(o.fov=new h["default"].FOV(e)),"up"in e&&(o.up=new h["default"].Up(e)),"position"in e&&(o.position=new h["default"].Position(e)),"lookat"in e&&(o.lookat=new h["default"].LookAt(e)),e=null,new Promise(function(e,a){function s(a){var u=Math.min(1,(a-c)/r),h=n(u);"fov"in o&&o.fov.apply(h),"up"in o&&o.up.apply(h),"position"in o&&o.position.apply(h),"lookat"in o&&o.lookat.apply(h),i.render(),1>u?t.cuadro=requestAnimationFrame(s):(o=n=r=null,c=a=null,u=h=null,e())}var c;cancelAnimationFrame(t.cuadro),c=window.performance.now(),s(c)})}),this}}]),t}();Object.defineProperties(l,{cuadro:{value:0,writable:!0},step:{value:function(t){this.cuadro=requestAnimationFrame(t)},writable:!1}}),i["default"]=l,e.exports=i["default"]},{"./Coordenada.js":6,"./easing.js":16,"./interprete.js":25}],5:[function(t,e,i){"use strict";function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(){this.needsUpdate=!0}Object.defineProperty(i,"__esModule",{value:!0});var a=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),c=function(){function t(e){n(this,t),this.id=e.id,this.name=e.name,this.texture=new THREE.Texture(new Image),this.texture.image.onload=o.bind(this.texture),this.changeSprite(1),this.card=new u(this)}return s(t,[{key:"changeSprite",value:function(t){this.sprite=t,this.texture.image.src=this.fullbodySpriteUri}},{key:"fullbodySpriteUri",get:function(){return t.RESOURCES_PATH+t.FULLBODY_PATH+this.id+"/"+this.sprite+".png"}},{key:"bustSpriteUri",get:function(){return t.RESOURCES_PATH+t.BUST_PATH+this.id+".png"}}]),t}();c.RESOURCES_PATH="/resources/",c.FULLBODY_PATH="sprites/",c.BUST_PATH="busts/",c.NARRATOR="narrator";var u=function(t){function e(t){n(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.card_front=new THREE.Mesh(e.geometry,new THREE.MeshBasicMaterial({map:t.texture,transparent:!0,color:16777215,side:THREE.FrontSide})),this.card_front.position.x=.02,this.card_back=new THREE.Mesh(e.geometry,new THREE.MeshBasicMaterial({map:t.texture,transparent:!0,color:0,side:THREE.BackSide})),this.card_back.position.x=-.02,this.add(this.card_front,this.card_back)}return r(e,t),s(e,[{key:"locateInStands",value:function(t){this.counter=Math.abs(t%16);var e=this.counter/16*(2*Math.PI);this.rotation.x=Math.PI/2,this.rotation.y=e-Math.PI/2,this.position.set(22*Math.cos(e),22*Math.sin(e),11),e=null}}]),e}(THREE.Object3D);u.geometry=new THREE.PlaneBufferGeometry(10,20),Object.defineProperty(c,"Card",{value:u,writable:!1}),i["default"]=c,e.exports=i["default"]},{}],6:[function(t,e,i){"use strict";function r(t){this._x=0,this._y=0,this._z=0,this.esferica=t.esferica||!!t[4],this.cx=t.cx||0,this.cy=t.cy||0,this.cz=t.cz||0,t instanceof r?(this._x=t._x,this._y=t._y,this._z=t._z):t.hasOwnProperty("x")?(this._x=t.x,this._y=t.y,this._z=t.z):t.hasOwnProperty("t")?(this.esferica=!0,this.setEsferica(t)):t.hasOwnProperty("p")?(this.setPolar(t),this.z=t.z):Array.isArray(t)&&(this._x=t[0],this._y=t[1],this._z=t[2])}Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperties(r.prototype,{toString:{writable:!1,value:function(){return JSON.stringify(this.vectorThree)}},x:{get:function(){return this._x-this.cx},set:function(t){this._x=this.cx+t}},y:{get:function(){return this._y-this.cy},set:function(t){this._y=this.cy+t}},z:{get:function(){return this._z-this.cz},set:function(t){this._z=this.cz+t}},r:{get:function(){var t=this._x-this.cx,e=this._y-this.cy,i=this._z-this.cz;return Math.sqrt(t*t+e*e+(this.esferica?i*i:0))},set:function(t){this.esferica?this.setEsferica(t,this.t,this.p):this.setPolar(t,this.p)}},t:{get:function(){var t=this._x-this.cx,e=this._y-this.cy,i=this._z-this.cz;return Math.acos(i/Math.sqrt(t*t+e*e+i*i))},set:function(t){this.setEsferica(this.r,t,this.p)}},p:{get:function(){return Math.atan2(this._y-this.cy,this._x-this.cx)},set:function(t){this.esferica?this.setEsferica(this.r,this.t,t):this.setPolar(this.r,t)}},centro:{get:function(){return[this.cx,this.cy,this.cz]},set:function(t){this.cx=t.x||t[0],this.cy=t.y||t[1],this.cz=t.z||t[2]}},vectorThree:{get:function(){return new THREE.Vector3(this.x,this.y,this.z)}},setEsferica:{value:function(t,e,i){t.hasOwnProperty("t")&&t.hasOwnProperty("p")&&(i=t.p,e=t.t,t=t.r),this._x=this.cx+t*Math.sin(e)*Math.cos(i),this._y=this.cy+t*Math.sin(e)*Math.sin(i),this._z=this.cz+t*Math.cos(e)}},setPolar:{value:function(t,e){t.hasOwnProperty("p")&&(e=t.p,t=t.r),this._x=this.cx+t*Math.cos(e),this._y=this.cy+t*Math.sin(e)}}}),i["default"]=r,e.exports=i["default"]},{}],7:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){var e=new THREE.Texture(new Image);return e.image.onload=s.bind(e),e.image.src=m.TEXTURE_RELATIVE_URI+t,e}function s(){this.needsUpdate=!0}Object.defineProperty(i,"__esModule",{value:!0});var c,u=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),h=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},l=t("./CylinderBufferGeometry.js"),f=r(l),p=t("./PlatformBufferGeometry.js"),d=r(p),y=t("./StandGeometry.js"),v=r(y),m=function(t){function e(t,i){n(this,e),h(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),c={WALLPAPER:a("chapter1-wallpaper.png"),BASEBOARD:a("chapter1-guardapolvo.png"),REDCARPET:a("alfombraR.png"),CURTAIN:a("chapter1-salida.png"),COLUMN:a("chapter1-marcos.png"),WOOD:a("wood.jpg"),CLOUDS:a("clouds.jpg")},t=t||120,i=i||80,this.add(new E(2*t,22),new w(8,i,t),new b(8,t-1).setCarpets(10,100).setCurtains(48).setPillars(3,i),new g,new x)}return o(e,t),e}(THREE.Object3D),E=function(t){function e(t,i){n(this,e);var r,o,a,s,c;for(t=t||120,i=i||18,r=new THREE.MeshFaceMaterial([new THREE.MeshLambertMaterial({color:0,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:4}),new THREE.MeshLambertMaterial({color:16777215,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:4})]),o=new THREE.PlaneGeometry(t,t,i,i),c=o.faces.length/2,a=0;c>a;a++)s=2*a,o.faces[s].materialIndex=(a+Math.floor(a/i))%2,o.faces[s+1].materialIndex=(a+Math.floor(a/i))%2;h(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,o,r),this.rotation.z=Math.PI/8,this.position.z=-.05,r=o=null}return o(e,t),e}(THREE.Mesh),w=function(t){function e(t,i,r){n(this,e),h(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var o,a;o=new THREE.MeshBasicMaterial({color:2959463,side:THREE.BackSide,map:c.WALLPAPER}),a=new f["default"](t,i,r),this.add(new THREE.Mesh(a,o)),c.BASEBOARD.wrapT=THREE.RepeatWrapping,c.BASEBOARD.repeat.set(2,1),o=new THREE.MeshBasicMaterial({color:11184810,side:THREE.BackSide,map:c.BASEBOARD}),a=new f["default"](t,.04*i,r-.05),this.add(new THREE.Mesh(a,o))}return o(e,t),e}(THREE.Object3D),b=function(t){function e(t,i){n(this,e),h(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.amount=t,this.apothem=i}return o(e,t),u(e,[{key:"setCurtains",value:function(t){var e,i,r,n,o;for(r=new THREE.PlaneBufferGeometry(t,t,1,1),n=new THREE.MeshBasicMaterial({color:15658734,side:THREE.FrontSide,map:c.CURTAIN,transparent:!0}),e=.5;e<this.amount;e++)i=2*Math.PI*e/this.amount,o=new THREE.Mesh(r,n),o.rotation.x=Math.PI/2,o.rotation.y=-i,o.position.x=this.apothem*Math.sin(i),o.position.y=this.apothem*Math.cos(i),o.position.z=t/2-1,this.add(o);return n=null,r=null,o=null,this}},{key:"setCarpets",value:function(t,e){var i,r,n,o,a;for(c.REDCARPET.wrapT=THREE.RepeatWrapping,c.REDCARPET.repeat.set(1,3),o=new THREE.MeshLambertMaterial({color:16777215,side:THREE.FrontSide,map:c.REDCARPET}),n=new THREE.PlaneBufferGeometry(t,e,1,1),i=.5;i<this.amount;i++)r=i/this.amount*2*Math.PI,a=new THREE.Mesh(n,o),a.rotation.z=r,a.position.x=(this.apothem-e/2)*Math.sin(-r),a.position.y=(this.apothem-e/2)*Math.cos(r),a.position.z=.05,this.add(a);return o=null,n=null,a=null,this}},{key:"setPillars",value:function(t,e){var i,r,n,o,a,s,u;for(i=c.COLUMN,i.wrapT=THREE.RepeatWrapping,i.repeat.set(1,2),r=new THREE.MeshBasicMaterial({color:16777215,side:THREE.FrontSide,map:i}),n=new f["default"](4,e,t),s=[0,.17578125,.4453125,.73046875,1],a=0;4>a;a++)n.attributes.uv.array[12*a+0]=s[a+1],n.attributes.uv.array[12*a+1]=1,n.attributes.uv.array[12*a+2]=s[a],n.attributes.uv.array[12*a+3]=1,n.attributes.uv.array[12*a+4]=s[a],n.attributes.uv.array[12*a+5]=0,n.attributes.uv.array[12*a+6]=s[a],n.attributes.uv.array[12*a+7]=0,n.attributes.uv.array[12*a+8]=s[a+1],n.attributes.uv.array[12*a+9]=0,n.attributes.uv.array[12*a+10]=s[a+1],n.attributes.uv.array[12*a+11]=1;for(u=Math.atan(.46*Math.tan(Math.PI/this.amount)),a=0;a<this.amount;a++)s=2*Math.PI*a/this.amount,o=new THREE.Mesh(n,r),o.rotation.z=Math.PI/2-s,o.position.x=this.apothem*Math.sin(s+u),o.position.y=this.apothem*Math.cos(s+u),this.add(o),o=new THREE.Mesh(n,r),o.rotation.z=Math.PI/2-s,o.position.x=this.apothem*Math.sin(s-u),o.position.y=this.apothem*Math.cos(s-u),this.add(o);return i=null,r=null,n=null,o=null,this}}]),e}(THREE.Object3D),g=function(t){function e(){n(this,e),h(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var t,i,r;t=new THREE.MeshBasicMaterial({color:16777215,side:THREE.FrontSide,map:c.REDCARPET}),i=new d["default"](17.5,27.5,32),r=new THREE.Mesh(i,t),r.position.z=1,this.add(r),t=new THREE.MeshBasicMaterial({color:0,side:THREE.FrontSide}),i=new THREE.CylinderGeometry(27.5,27.5,1,32,1,!0),r=new THREE.Mesh(i,t),r.rotation.x=Math.PI/2,r.rotation.y=11.25*Math.PI/180,r.position.z=.5,this.add(r),t=null,i=null,r=null}return o(e,t),e}(THREE.Object3D),x=function(t){function e(){n(this,e),h(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var t,i,r,o,a,s,u;for(t=c.WOOD,i=new THREE.MeshLambertMaterial({color:16777215,emissive:3355443,side:THREE.BackSide,map:t}),r=new THREE.CylinderGeometry(17.5,15.5,1,16,1,!0),r.faceVertexUvs[0]=[],s=[new THREE.Vector2(0,1),new THREE.Vector2(0,0),new THREE.Vector2(1,1)],u=[new THREE.Vector2(0,0),new THREE.Vector2(1,0),new THREE.Vector2(1,1)],a=0;16>a;a++)r.faceVertexUvs[0].push(s),r.faceVertexUvs[0].push(u);for(o=new THREE.Mesh(r,i),o.name="platfront",o.rotation.x=Math.PI/2,o.rotation.y=11.25*Math.PI/180,o.position.z=.5,this.add(o),i=new THREE.MeshLambertMaterial({color:16777215,emissive:2236962,side:THREE.FrontSide,map:t}),r=[new v["default"](17,1),new THREE.BoxGeometry(7,1.5,1),new THREE.BoxGeometry(7,1.2,1)],a=0;16>a;a++)o=new THREE.Mesh(r[0],i),o.rotation.z=360*(a+.5)/16*Math.PI/180,this.add(o),o=new THREE.Mesh(r[1],i),o.rotation.z=(90+360*a/16)*Math.PI/180,o.position.x=19.1*Math.cos(a/8*Math.PI),o.position.y=19.1*Math.sin(a/8*Math.PI),o.position.z=9.8,this.add(o),o=new THREE.Mesh(r[2],i),o.rotation.z=(90+360*a/16)*Math.PI/180,o.position.x=17.5*Math.cos(a/8*Math.PI),o.position.y=17.5*Math.sin(a/8*Math.PI),o.position.z=1.6,this.add(o);t=c.CLOUDS,t.wrapT=t.wrapS=THREE.RepeatWrapping,t.repeat.set(30,1),i=new THREE.MeshLambertMaterial({color:3377551,emissive:3377551,side:THREE.FrontSide,map:t}),r=new THREE.TorusGeometry(16.2,.35,10,80),o=new THREE.Mesh(r,i),o.position.z=10.1,this.add(o),t=i=r=o=null}return o(e,t),e}(THREE.Object3D);Object.defineProperties(m,{TEXTURE_RELATIVE_URI:{value:"/resources/textures/"},CylinderBufferGeometry:{value:f["default"]},PlatformBufferGeometry:{value:d["default"]},StandGeometry:{value:v["default"]},Floor:{value:E},Walls:{value:w},Exits:{value:b},Platform:{value:g},TrialStands:{value:x}}),i["default"]=m,e.exports=i["default"]},{"./CylinderBufferGeometry.js":8,"./PlatformBufferGeometry.js":10,"./StandGeometry.js":11}],8:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var o=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},a=function(t){function e(t,i,n){r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.type="CylinderBufferGeometry";var a,s,c,u,h,l=n/Math.cos(Math.PI/t),f=2*Math.PI/t,p=new Float32Array(6*t*3),d=new Float32Array(6*t*2);for(a=0;t>=a;a++)s=l*Math.cos(f*(a-.5)),c=l*Math.sin(f*(a-.5)),u=l*Math.cos(f*(a+.5)),h=l*Math.sin(f*(a+.5)),d[12*a+0]=1,d[12*a+1]=1,p[18*a+0]=u,p[18*a+1]=h,p[18*a+2]=i,d[12*a+2]=0,d[12*a+3]=1,p[18*a+3]=s,p[18*a+4]=c,p[18*a+5]=i,d[12*a+4]=0,d[12*a+5]=0,p[18*a+6]=s,p[18*a+7]=c,p[18*a+8]=0,d[12*a+6]=0,d[12*a+7]=0,p[18*a+9]=s,p[18*a+10]=c,p[18*a+11]=0,d[12*a+8]=1,d[12*a+9]=0,p[18*a+12]=u,p[18*a+13]=h,p[18*a+14]=0,d[12*a+10]=1,d[12*a+11]=1,p[18*a+15]=u,p[18*a+16]=h,p[18*a+17]=i;this.addAttribute("position",new THREE.BufferAttribute(p,3)),this.addAttribute("uv",new THREE.BufferAttribute(d,2)),s=c=null,u=h=null,d=null,p=null}return n(e,t),e}(THREE.BufferGeometry);i["default"]=a,e.exports=i["default"]},{}],9:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("./hud/Element.js"),s=r(a),c=t("./hud/DiscussionScreen.js"),u=r(c),h=t("./hud/NSDScreen.js"),l=r(h),f=function(){function t(e,i){n(this,t);var r=document.createElement("canvas"),o=r.getContext("2d");r.width=e,r.height=i,this.W=e,this.H=i,this.ctx=o,this.canvas=r,this.blackScreen=0,this.children=[],o=r=null}return o(t,[{key:"add",value:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("HUD.add: object can't be added as a child of itself.",t),this):(t instanceof s["default"]?(void 0!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("HUD.add: object not an instance of HUDElement.",t),this)}},{key:"remove",value:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);-1!==i&&(t.parent=void 0,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))}},{key:"getChildrenByType",value:function(t){for(var e=[],i=this.children.length;i--;)this.children[i].type==t&&e.push(this.children[i]),this.children[i].children.length>0&&(e=e.concat(this.children[i].getChildrenByType(t)));return e}},{key:"setScreen",value:function(t){switch(this.getChildrenByType("HUD.Screen").forEach(this.remove,this),t){case"nsd":screen=new l["default"](this.ctx);break;case"discussion":default:screen=new u["default"](this.ctx)}return this.add(screen),screen}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.W,this.H)}},{key:"drawBlackScreen",value:function(t){this.ctx.save(),console.log(this.blackScreen),this.globalAlpha=this.blackScreen,this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.W,this.H),this.ctx.restore()}},{key:"draw",value:function(t){this.ctx.clearRect(0,0,this.W,this.H);for(var e=this.children.length;e--;)this.children[e].draw(t);this.blackScreen>0&&this.drawBlackScreen()}}]),t}();i["default"]=f,e.exports=i["default"]},{"./hud/DiscussionScreen.js":17,"./hud/Element.js":18,"./hud/NSDScreen.js":22}],10:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var o=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},a=function(t){function e(t,i,n){r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.type="PlatformBufferGeometry",t=t||20,i=i||31,n=n||32;var a,s,c,u,h,l=2*Math.PI/n,f=new Float32Array(6*n*3),p=new Float32Array(6*n*2);for(a=0;n>a;a++)s=Math.cos(l*a),c=Math.sin(l*a),u=Math.cos(l*(a+1)),h=Math.sin(l*(a+1)),p[12*a+0]=0,p[12*a+1]=0,f[18*a+0]=t*s,f[18*a+1]=t*c,f[18*a+2]=0,p[12*a+2]=1,p[12*a+3]=0,f[18*a+3]=i*s,f[18*a+4]=i*c,f[18*a+5]=0,p[12*a+4]=1,p[12*a+5]=1,f[18*a+6]=i*u,f[18*a+7]=i*h,f[18*a+8]=0,p[12*a+6]=1,p[12*a+7]=1,f[18*a+9]=i*u,f[18*a+10]=i*h,f[18*a+11]=0,p[12*a+8]=0,p[12*a+9]=1,f[18*a+12]=t*u,f[18*a+13]=t*h,f[18*a+14]=0,p[12*a+10]=0,p[12*a+11]=0,f[18*a+15]=t*s,f[18*a+16]=t*c,f[18*a+17]=0;this.addAttribute("position",new THREE.BufferAttribute(f,3)),this.addAttribute("uv",new THREE.BufferAttribute(p,2)),s=c=null,u=h=null,p=null,f=null}return n(e,t),e}(THREE.BufferGeometry);i["default"]=a,e.exports=i["default"]},{}],11:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var o=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},a=function(t){function e(t,i){r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.vertices.push(new THREE.Vector3(.8,t-2,i+10.2),new THREE.Vector3(-.8,t-2,i+10.2),new THREE.Vector3(-.8,t-2,i+8.7),new THREE.Vector3(.8,t-2,i+8.7),new THREE.Vector3(.8,t+4,i+10.2),new THREE.Vector3(-.8,t+4,i+10.2),new THREE.Vector3(-.8,t+4,i+8.5),new THREE.Vector3(.8,t+4,i+8.5),new THREE.Vector3(.8,t+0,i+7.5),new THREE.Vector3(-.8,t+0,i+7.5),new THREE.Vector3(-.8,t+3,i+7.5),new THREE.Vector3(.8,t+3,i+7.5)),this.faces.push(new THREE.Face3(0,1,2),new THREE.Face3(2,3,0),new THREE.Face3(3,2,9),new THREE.Face3(9,8,3),new THREE.Face3(4,5,1),new THREE.Face3(1,0,4),new THREE.Face3(4,0,3),new THREE.Face3(3,7,4),new THREE.Face3(7,3,8),new THREE.Face3(8,11,7),new THREE.Face3(1,5,6),new THREE.Face3(6,2,1),new THREE.Face3(2,6,10),new THREE.Face3(10,9,2),new THREE.Face3(5,4,7),new THREE.Face3(7,6,5),new THREE.Face3(6,7,11),new THREE.Face3(11,10,6),new THREE.Face3(8,9,10),new THREE.Face3(10,11,8)),this.vertices.push(new THREE.Vector3(.6,t+.2,i+7.5),new THREE.Vector3(-.6,t+.2,i+7.5),new THREE.Vector3(-.6,t+.2,i+1.1),new THREE.Vector3(.6,t+.2,i+1.1),new THREE.Vector3(-.6,t+2.8,i+7.5),new THREE.Vector3(.6,t+2.8,i+7.5),new THREE.Vector3(.6,t+2.8,i+1.1),new THREE.Vector3(-.6,t+2.8,i+1.1)),this.faces.push(new THREE.Face3(12,13,14),new THREE.Face3(14,15,12),new THREE.Face3(16,17,18),new THREE.Face3(18,19,16),new THREE.Face3(17,12,15),new THREE.Face3(15,18,17),new THREE.Face3(13,16,19),new THREE.Face3(19,14,13)),this.vertices.push(new THREE.Vector3(.8,t+0,i+1.4),new THREE.Vector3(-.8,t+0,i+1.4),new THREE.Vector3(-.8,t+0,i+0),new THREE.Vector3(.8,t+0,i+0),new THREE.Vector3(-.8,t+3,i+1.4),new THREE.Vector3(.8,t+3,i+1.4),new THREE.Vector3(.8,t+4,i+.7),new THREE.Vector3(-.8,t+4,i+.7),new THREE.Vector3(.8,t+4,i+0),new THREE.Vector3(-.8,t+4,i+0)),this.faces.push(new THREE.Face3(20,21,22),new THREE.Face3(22,23,20),new THREE.Face3(25,24,21),new THREE.Face3(21,20,25),new THREE.Face3(20,23,28),new THREE.Face3(28,26,20),new THREE.Face3(26,25,20),new THREE.Face3(24,25,26),new THREE.Face3(26,27,24),new THREE.Face3(27,26,28),new THREE.Face3(28,29,27),new THREE.Face3(21,24,27),new THREE.Face3(21,27,29),new THREE.Face3(21,29,22));var n=this.faces.length/2,a=[new THREE.Vector2(0,1),new THREE.Vector2(0,0),new THREE.Vector2(1,1)],s=[new THREE.Vector2(0,0),new THREE.Vector2(1,0),new THREE.Vector2(1,1)];for(this.faceVertexUvs[0]=[];n--;)this.faceVertexUvs[0].push(a,s);this.computeFaceNormals(),this.computeVertexNormals()}return n(e,t),e}(THREE.Geometry);i["default"]=a,e.exports=i["default"]},{}],12:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),e.center=e.center||{x:0,y:0,z:0},this.cx=e.center.x,this.cy=e.center.y,this.cz=e.center.z,this.ax=e.start.x-this.cx,this.ay=e.start.y-this.cy,this.az=e.start.z-this.cz,this.ar=Math.sqrt(this.ax*this.ax+this.ay*this.ay+("spherical"==e.type?this.az*this.az:0)),
this.ap=Math.atan2(this.ay,this.ax),this.at=Math.acos(this.az/Math.sqrt(this.ax*this.ax+this.ay*this.ay+this.az*this.az)),this.bx=e.end.x-this.cx,this.by=e.end.y-this.cy,this.bz=e.end.z-this.cz,this.br=Math.sqrt(this.bx*this.bx+this.by*this.by+("spherical"==e.type?this.bz*this.bz:0)),this.bp=Math.atan2(this.by,this.bx),this.bt=Math.acos(this.bz/Math.sqrt(this.bx*this.bx+this.by*this.by+this.bz*this.bz)),this.bp-this.ap>Math.PI?this.ap+=2*Math.PI:this.bp-this.ap<-Math.PI&&(this.bp+=2*Math.PI),this.route=e.route||"linear",this.geometry=new THREE.SphereGeometry(.1,4,4),this.material=new THREE.MeshBasicMaterial({color:Math.floor(16777215*Math.random())}),e=null}return n(t,[{key:"getVector",value:function(t){return{x:this.getX(t),y:this.getY(t),z:this.getZ(t)}}},{key:"getVectorThree",value:function(t){return new THREE.Vector3(this.getX(t),this.getY(t),this.getZ(t))}},{key:"getX",value:function(t){return"spherical"==this.route?this.cx+this.getR(t)*Math.sin(this.getT(t))*Math.cos(this.getP(t)):"circular"==this.route?this.cx+this.getR(t)*Math.cos(this.getP(t)):(1-t)*this.ax+t*this.bx}},{key:"getY",value:function(t){return"spherical"==this.route?this.cy+this.getR(t)*Math.sin(this.getT(t))*Math.sin(this.getP(t)):"circular"==this.route?this.cy+this.getR(t)*Math.sin(this.getP(t)):(1-t)*this.ay+t*this.by}},{key:"getZ",value:function(t){return"spherical"==this.route?this.cz+this.getR(t)*Math.cos(this.getT(t)):(1-t)*this.az+t*this.bz}},{key:"getR",value:function(t){return(1-t)*this.ar+t*this.br}},{key:"getP",value:function(t){return(1-t)*this.ap+t*this.bp}},{key:"getT",value:function(t){return(1-t)*this.at+t*this.bt}}]),t}();i["default"]=o,e.exports=i["default"]},{}],13:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("./animation/DiscussionAnimation.js"),s=r(a),c=t("./animation/NSDAnimation.js"),u=r(c),h=t("./Character.js"),l=r(h),f=t("./HUD.js"),p=r(f),d=function(){function t(e,i){n(this,t),this.WIDTH=e,this.HEIGHT=i,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setClearColor(0,1),this.renderer.setSize(e,i),this.scene=new THREE.Scene,this.cameras=[],this.characters={};var r=new THREE.PointLight(16777215,1.5,130);r.position.set(0,0,30),this.scene.add(r),this.createCamera(),this.animation=new s["default"](this)}return o(t,[{key:"createCamera",value:function(t){var e=new THREE.PerspectiveCamera(40,this.WIDTH/this.HEIGHT,1,300);e.position.set(10,10,10),e.lookAt(new THREE.Vector3(0,0,10)),this.cameras.push(e),this.scene.add(e),this.mainCamera=e}},{key:"setBear",value:function(){var t=new l["default"]({id:"monokuma",name:"Monokuma"});this.scene.add(t.card)}},{key:"setCharacter",value:function(t,e){t&&(t=new l["default"](t),this.characters[t.id]=t,this.scene.add(t.card),t.card.locateInStands(e))}},{key:"changeStage",value:function(t){switch(t){case"discussion":this.animation=new s["default"](this);break;case"nsd":this.animation=new u["default"](this)}return this.hud.setScreen(t)}},{key:"appendCanvasTo",value:function(t){return("string"==typeof t?document.querySelector(t):t).appendChild(this.renderer.domElement),this}},{key:"setupHUD",value:function(t,e){return this.hud=new p["default"](this.WIDTH,this.HEIGHT),this.hud.canvas.id=e||"hud",document.querySelector(t).appendChild(this.hud.canvas),this}},{key:"render",value:function(t){this.renderer.render(this.scene,this.mainCamera),this.hud.draw(t)}},{key:"renderHalf",value:function(){this.renderer.setViewport(0,0,this.WIDTH,this.HEIGHT),this.renderer.clear(),this.renderer.setViewport(1,1,.5*this.WIDTH-2,this.HEIGHT-2),this.renderer.render(this.scene,this.mainCamera),this.renderer.setViewport(.5*this.WIDTH+1,1,.5*this.WIDTH-2,this.HEIGHT-2),this.renderer.render(this.scene,this.rightCamera)}}]),t}();i["default"]=d,e.exports=i["default"]},{"./Character.js":5,"./HUD.js":9,"./animation/DiscussionAnimation.js":14,"./animation/NSDAnimation.js":15}],14:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},c=t("./../Coordenada.js"),u=r(c),h=t("./../Animation.js"),l=r(h),f=function(t){function e(t){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return o(e,t),a(e,[{key:"tutorial",value:function(){var t,e,i=this.trial;return i.mainCamera.up.set(0,0,1),i.mainCamera.fov=40,i.mainCamera.updateProjectionMatrix(),e=function(r){l["default"].cuadro=requestAnimationFrame(e);var n=(r-t)/1e3*.04*Math.PI,o=Math.sin(n),a=Math.cos(n);n=null,i.mainCamera.position.set(-28*a,-28*o,33),i.mainCamera.lookAt(new THREE.Vector3(19*a,19*o,9)),o=null,a=null,i.render(r)},this.promise=this.promise.then(function(){cancelAnimationFrame(l["default"].cuadro),t=window.performance.now(),e(t)}),this}},{key:"cuestionamiento",value:function(){return this.cortarHacia({fov:40,up:new u["default"]([0,0,1]),position:new u["default"]({r:3,p:1.5707963267,z:14}),lookat:new u["default"]({r:19,p:1.5707963267,z:13})}).transicion({duration:600,position:new u["default"]({r:1,p:1.5707963267,z:14}),lookat:new u["default"]({r:19,p:1.5707963267,z:13}),easing:"inOutQuad"}).transicion({duration:600,fov:60,position:new u["default"]({r:10,p:1.5707963267,z:15}),lookat:new u["default"]({r:19,p:1.5707963267,z:13.4}),easing:"inOutQuad"})}},{key:"exitSpin",value:function(){var t=this.trial;return this.promise=this.promise.then(function(){return new Promise(function(e){var i,r,n=new u["default"](t.mainCamera.position);t.mainCamera.up.set(0,0,1),r=function(o){var a=(o-i)/1e3,s=n.r*(1-a/2)+28*a/2,c=Math.PI+n.p-a*Math.PI,u=Math.sin(c),h=Math.cos(c);t.mainCamera.position.set(-s*h,-s*u,33-7*a),t.mainCamera.lookAt(new THREE.Vector3(19*h,19*u,9)),a>1&&(t.hud.blackScreen=a-1),t.render(o),2>a?l["default"].cuadro=requestAnimationFrame(r):(t.hud.clear(),e())},l["default"].stop(),i=window.performance.now(),r(i)})}),this}}]),e}(l["default"]);i["default"]=f,e.exports=i["default"]},{"./../Animation.js":4,"./../Coordenada.js":6}],15:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},c=t("./../Coordenada.js"),u=(r(c),t("./../Animation.js")),h=r(u),l=function(t){function e(t){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return o(e,t),a(e,[{key:"introNSD",value:function(){var t=this.trial;return this.promise=this.promise.then(function(){return new Promise(function(e,i){var r,n;r=function(i){var o=Math.min(1,(i-n)/3500),a=2.125*(o-.25)*Math.PI;t.mainCamera.position.set((56-46*Math.pow(o,2))*Math.cos(a),(56-46*Math.pow(o,2))*Math.sin(a),35-18*o),t.mainCamera.up.set(.16*(1-o)*Math.sin(a),-.16*(1-o)*Math.cos(a),1),t.mainCamera.lookAt(new THREE.Vector3(0,0,10+6*o)),.3>o&&t.hud.blackScreen((.3-o)/.3),t.render(),1>o?h["default"].cuadro=requestAnimationFrame(r):(t.hud.clear(),e())},cancelAnimationFrame(h["default"].cuadro),n=performance.now(),r(n)})}),this}},{key:"presentBullets",value:function(t){var e=this.trial;return this.promise=this.promise.then(function(){return new Promise(function(t,i){var r,n=0,o=2*Math.random()*Math.PI,a=e.hud.getChildByType("HUD.Cylinder");r=function(i){var s=o+(i-n)/1e3*.1*Math.PI,c=Math.sin(s),u=Math.cos(s);e.mainCamera.position.set(8*u,8*c,16),e.mainCamera.up.set(.1*c,-.1*u,1),e.mainCamera.lookAt(new THREE.Vector3(20*u,20*c,16)),e.render(i),a.draw(i)?(e.hud.clear(),t()):h["default"].cuadro=requestAnimationFrame(r)},cancelAnimationFrame(h["default"].cuadro),n=performance.now(),r(n)})}),this}}]),e}(h["default"]);i["default"]=l,e.exports=i["default"]},{"./../Animation.js":4,"./../Coordenada.js":6}],16:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={linear:function(t){return t},inQuad:function(t){return t*t},outQuad:function(t){return-t*(t-2)},inOutQuad:function(t){return.5*((t*=2)<1?t*t:t*(2-t)-2)},inCubic:function(t){return t*t*t},outCubic:function(t){return Math.pow(t-1,3)+1},inOutCubic:function(t){return.5*((t*=2)<1?t*t*t:Math.pow(2*t-2,3)+2)},inSine:function(t){return 1-Math.cos(t*Math.PI/2)},outSine:function(t){return Math.sin(t*Math.PI/2)},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return Math.pow(1024,t-1)},easeOutExpo:function(t){return 1.0009765626-Math.pow(1024,-t)},easeInOutExpo:function(t){return.5*((t*=2)<1?Math.pow(1024,t-1):2-Math.pow(1024,1-t))}},e.exports=i["default"]},{}],17:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},c=t("./Screen.js"),u=r(c),h=t("./TextElement.js"),l=r(h),f=t("./../Character.js"),p=function(t){function e(t){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.gradients=function(){var e=t.canvas.width,i=t.createLinearGradient(0,0,e,0),r=t.createLinearGradient(0,0,e,0),n=t.createLinearGradient(0,0,e,0);return i.addColorStop(0,"#CC0000"),i.addColorStop(.65,"rgb(255, 51, 51)"),i.addColorStop(.75,"rgba(255, 51, 51, 0)"),r.addColorStop(.65,"rgb(255, 51, 51)"),r.addColorStop(.75,"rgba(255, 51, 51, 0)"),n.addColorStop(.65,"rgb(255, 51, 51)"),n.addColorStop(.75,"rgba(255, 51, 51, 0)"),{nameprotagLeft:i,nametagLeft:r,nametagRight:n}}(),this.caseNumber="02",this.banner_x=0,this.speakerCardTimer=0,this.speakerCardImage=new Image,this.speakerCardImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",this.dialogue=new l["default"](t),this.dialogue.x=.05*this.W,this.dialogue.y=.8*this.H,this.dialogue.typewrite=!0,this.nametag=new l["default"](t),this.nametag.x=.03*this.W,this.nametag.y=.675*this.H,this.nametag.font=.04*this.H+"px DorBlue",this.add(this.dialogue,this.nametag),console.log(f.NARRATOR)}return o(e,t),a(e,[{key:"setDialogue",value:function(t,i){this.speakerId!=t.id&&(this.generateInterferencePattern(),this.interferenceOpacity=1,this.nametag.marginLeft=.04*this.W,this.nametag.opacity=0),this.speakerId=t.id,this.speakerIsProtagonist=0==t.card.counter,this.speakerCardImage.src=t.bustSpriteUri,this.nametag.text=t.name.split("").join(String.fromCharCode(8201)),this.dialogue.color=e[t.id==f.NARRATOR?"COLOR_NARRATOR":"COLOR_CHARACTER"],this.dialogue.text=i,this.dialogue.typewLength=0}},{key:"setSpeaker",value:function(t){}},{key:"generateInterferencePattern",value:function(){this.interferencePattern=this.ctx.createLinearGradient(0,.08*this.H,0,.63*this.H);for(var t,e="0",i="0",r=Math.floor(this.H/100);r--;)e+=Math.floor(500*Math.random()).toString(2),i+=Math.floor(500*Math.random()).toString(2);for(t=r=Math.min(e.length,i.length);r--;)e[r]!=i[r]&&(this.interferencePattern.addColorStop(r/t-.005,"#ff3333"),this.interferencePattern.addColorStop(r/t,"#ffffff"),this.interferencePattern.addColorStop(r/t+.005,"#ff3333"))}},{key:"drawClassTrialBanner",value:function(){this.ctx.save(),this.ctx.font=.08*this.H+"px Goodbye Despair",this.ctx.globalAlpha=.5,this.ctx.fillStyle="rgba(255,255,255,0.5)",this.ctx.strokeStyle="white",this.ctx.lineWidth=this.H/500;var t=this.ctx.measureText("class trial ").width;this.ctx.fillText("class trial class trial class trial class trial class trial ",this.banner_x,.06*this.H),this.ctx.strokeText("class trial class trial class trial class trial class trial ",this.banner_x,.06*this.H),this.banner_x-=this.W/1e3,this.banner_x<-t&&(this.banner_x+=t),t=null,this.ctx.restore()}},{key:"drawSpeakerCard",value:function(){var t,e=.19*this.W;this.speakerCardTimer+=.03,this.speakerCardTimer>=1&&(this.speakerCardTimer=-1),this.ctx.save(),this.ctx.fillStyle="black",this.ctx.fillRect(0,0,e,.63*this.H),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(.1*this.W,0),this.ctx.lineTo(.1*this.W+.07*this.H,.07*this.H),this.ctx.lineTo(0,.07*this.H),this.ctx.closePath(),this.ctx.fillStyle="#999999",this.ctx.fill(),this.ctx.font=.06*this.H+"px Goodbye Despair",this.ctx.fillStyle="#ffffff",this.ctx.fillText("case",.01*this.W,.054*this.H),this.ctx.textAlign="right",this.ctx.fillStyle="#ff3333",this.ctx.fillText(this.caseNumber,.19*this.W-.01*this.H,.054*this.H),this.ctx.restore(),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(0,.075*this.H,e-.005*this.H,.55*this.H),this.ctx.clip();var i=this.ctx.createLinearGradient(0,(-1.02+.55*this.speakerCardTimer)*this.H,0,(.08+1.1+.55*this.speakerCardTimer)*this.H);for(i.addColorStop(0,"#FF0000"),i.addColorStop(.25,"#000000"),i.addColorStop(.5,"#FF0000"),i.addColorStop(.75,"#000000"),i.addColorStop(1,"#FF0000"),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,e,this.H),i=null,this.ctx.strokeStyle="#"+("0"+Math.floor(Math.abs(255*this.speakerCardTimer)).toString(16)).slice(-2)+"0000",this.ctx.lineWidth=this.H/200,t=.625+e/this.H;t>.075;)this.ctx.beginPath(),this.ctx.moveTo(e-.0025*this.H,t*this.H),this.ctx.lineTo(-.0025*this.H,t*this.H-e),this.ctx.stroke(),t-=.03;t=1.8*.55*this.H,this.ctx.drawImage(this.speakerCardImage,(e-t/this.speakerCardImage.naturalHeight*this.speakerCardImage.naturalWidth)/2,.075*this.H,t/this.speakerCardImage.naturalHeight*this.speakerCardImage.naturalWidth,t),this.interferenceOpacity>0&&(this.ctx.globalAlpha=this.interferenceOpacity,this.ctx.fillStyle=this.interferencePattern,this.ctx.fillRect(0,.075*this.H,e,.55*this.H),this.interferenceOpacity-=.08),this.ctx.restore(),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=this.H/500,this.ctx.beginPath(),this.ctx.moveTo(e-.005*this.H,0),this.ctx.lineTo(e-.005*this.H,.07*this.H),this.ctx.stroke(),this.ctx.strokeRect(-.005*this.H,.075*this.H,e,.55*this.H),this.ctx.restore(),e=null}},{key:"drawDialogBackground",value:function(){this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, 0.8)",this.ctx.fillRect(0,.69*this.H,this.W,.31*this.H),this.ctx.fillStyle=this.gradients[this.speakerIsProtagonist?"nameprotagLeft":"nametagLeft"],this.ctx.fillRect(0,.63*this.H,this.W,.06*this.H),this.ctx.fillStyle="white",this.ctx.fillRect(0,.693*this.H,this.W,.02*this.H),this.ctx.fillStyle="#FF0066",this.ctx.fillRect(0,.713*this.H,this.W,.01*this.H),this.ctx.restore()}},{key:"draw",value:function(t){this.ctx.clearRect(0,0,this.W,this.H),this.drawClassTrialBanner(),this.drawDialogBackground(),this.speakerId!=f.NARRATOR&&this.drawSpeakerCard(),this.dialogue.draw(),this.nametag.marginLeft>0&&(this.nametag.marginLeft-=.005*this.W),this.nametag.opacity<1&&(this.nametag.opacity+=.1),this.nametag.draw()}}]),e}(u["default"]);p.COLOR_NARRATOR="#47FF19",p.COLOR_CHARACTER="white",i["default"]=p,e.exports=i["default"]},{"./../Character.js":5,"./Screen.js":23,"./TextElement.js":24}],18:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.type="HUD.Element",this.ctx=e,this.W=e.canvas.width,this.H=e.canvas.height,this.relative_x=0,this.relative_y=0,this.visible=!0,this.opacity=1,this.parent=void 0,this.children=[],this.events={}}return n(t,[{key:"add",value:function(e){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("HUD.Element$add: object can't be added as a child of itself.",e),this):(e instanceof t?(void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("HUD.Element$add: object not an instance of HUDElement.",e),this)}},{key:"remove",value:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);-1!==i&&(t.parent=void 0,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))}},{key:"getChildrenByType",value:function(t){for(var e=[],i=this.children.length;i--;)this.children[i].type==t&&e.push(this.children[i]),this.children[i].children.length>0&&(e=e.concat(this.children[i].getChildrenByType(t)));return e}},{key:"getChildByType",value:function(t){for(var e,i=0,r=this.children.length,i=0;i<this.children.length;i++){if(this.children[r].type==t)return this.children[r];if(this.children[r].children.length>0&&(e=this.children[r].getChildByType(t)))return e}}},{key:"dispatchEvent",value:function(t){t.type in this.events&&this.events[t.type].forEach(function(e){e(t)})}},{key:"listenEvent",value:function(t,e){t in this.events||(this.events[t]=[]),this.events[t].push(e)}},{key:"draw",value:function(t){throw new Error("HUD.Element$draw: Method not implemented.",this.type)}}]),t}();i["default"]=o,e.exports=i["default"]},{}],19:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},c=t("./Element.js"),u=r(c),h=function(){function t(t){var e=new Image;return e.src=t,e}return{BOTTOM:t("/resources/textures/bullet_1.svg"),BODY:t("/resources/textures/bullet_2.svg"),CAP:t("/resources/textures/bullet_3.svg")}}(),l=function(t){function e(t,i,r){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.order=r,this.text=i,this.x=0,this.y=0,this.setScale(1)}return o(e,t),a(e,[{key:"setScale",value:function(t){this.scale=t,this.font=Math.floor(36*t)+"px Calibri",this.ctx.save(),this.ctx.font=this.font,this.textWidth=Math.floor(this.ctx.measureText(this.text).width),this.ctx.restore()}},{key:"draw",value:function(t){var e=h.BOTTOM.naturalHeight*this.scale,i=h.BOTTOM.naturalWidth*this.scale,r=h.CAP.naturalWidth*this.scale,n=60*this.y*this.scale;this.ctx.save(),this.ctx.globalAlpha=this.opacity,this.ctx.drawImage(h.BOTTOM,this.x,n-e/2,i,e),this.ctx.drawImage(h.BODY,this.x+i-1,n-e/2,this.textWidth,e),this.ctx.drawImage(h.CAP,this.x+i+this.textWidth-2,n-e/2,r,e),this.ctx.beginPath(),this.ctx.font=this.font,this.ctx.textAlign="left",this.ctx.textBaseline="middle",this.ctx.fillStyle="white",this.ctx.fillText(this.text,this.x+.6*i,n),this.ctx.restore()}}]),e}(u["default"]);i["default"]=l,e.exports=i["default"]},{"./Element.js":18}],20:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},c=t("./Element.js"),u=r(c),h=function(t){function e(t){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.type="HUD.NSD.Cylinder",this.bullets=[],this.giro=0}return o(e,t),a(e,[{key:"setScale",value:function(){this.r=.45*this.H*.8,this.x=this.r*-.1,this.y=.58*this.H;for(var t=this.bullets.length;t--;)this.bullets[t].setScale(this.r/200)}},{key:"loadBullet",value:function(t){this.bullets.push(t),t.setScale(this.r/200)}}]),e}(u["default"]);i["default"]=h,e.exports=i["default"]},{"./Element.js":18}],21:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},c=t("./NSDCylinder.js"),u=r(c),h=function(t){function e(t){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return o(e,t),a(e,[{key:"dibujarCilindro",value:function(){var t,e;for(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(0,0,this.r+10,0,2*Math.PI),this.ctx.clip(),this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="#d40000",this.ctx.beginPath(),this.ctx.arc(0,0,this.r,0,2*Math.PI),this.ctx.fill(),this.ctx.fillStyle="black",t=0;6>t;t++)e=this.giro+Math.PI*t/3,this.ctx.beginPath(),this.ctx.arc(.63*this.r*Math.cos(e),.63*this.r*Math.sin(e),.24*this.r,0,2*Math.PI),this.ctx.fill();for(this.ctx.globalCompositeOperation="destination-out",t=.5;6>t;t++)e=this.giro+Math.PI*t/3,this.ctx.beginPath(),this.ctx.arc(1.67*this.r*Math.cos(e),1.67*this.r*Math.sin(e),.76*this.r,0,2*Math.PI),this.ctx.fill();this.ctx.restore()}},{key:"dibujarArcoExterior",value:function(t){this.ctx.lineCap="square",this.ctx.globalCompositeOperation="source-over",this.ctx.strokeStyle="white",this.ctx.lineWidth=.1*this.r;for(var e=0;4>e;e++)this.ctx.beginPath(),this.ctx.arc(0,0,1.17*this.r,t+Math.PI*e/2,t+Math.PI*e/2+1.4),this.ctx.stroke();this.ctx.globalCompositeOperation="destination-out",this.ctx.lineWidth=.08*this.r;for(var e=0;4>e;e++)this.ctx.beginPath(),this.ctx.arc(0,0,1.17*this.r,t+Math.PI*e/2,t+Math.PI*e/2+1.4),this.ctx.stroke();this.ctx.globalCompositeOperation="source-over",this.ctx.strokeStyle="rgba(255,255,255,0.3)",this.ctx.lineWidth=.09*this.r;for(var e=0;4>e;e++)this.ctx.beginPath(),this.ctx.arc(0,0,1.17*this.r,t+Math.PI*e/2,t+Math.PI*e/2+1.4),this.ctx.stroke()}},{key:"dibujarArcoInterior",value:function(t){this.ctx.globalCompositeOperation="source-over",this.ctx.strokeStyle="white",this.ctx.lineCap="square",this.ctx.lineWidth=.05*this.r;for(var e=0;2>e;e++)this.ctx.beginPath(),this.ctx.arc(0,0,1.0625*this.r,Math.PI*e-t,Math.PI*e+3-t),this.ctx.stroke();this.ctx.globalCompositeOperation="destination-out",this.ctx.lineWidth=.036*this.r;for(var e=0;2>e;e++)this.ctx.beginPath(),this.ctx.arc(0,0,1.0625*this.r,Math.PI*e-t,Math.PI*e+3-t),this.ctx.stroke();this.ctx.globalCompositeOperation="source-over",this.ctx.strokeStyle="rgba(255,255,255,0.3)",this.ctx.lineWidth=.04*this.r;for(var e=0;2>e;e++)this.ctx.beginPath(),this.ctx.arc(0,0,1.0625*this.r,Math.PI*e-t,Math.PI*e+3-t),this.ctx.stroke()}},{key:"draw",value:function(t){var e,i,r,n,o,a,s,c;if(.25>t?this.x=(7.6*t-2)*this.r:(this.x=-.1*this.r,this.giro=0,i=this.bullets.length,r=Math.min(2.4*t-.6,i)),this.ctx.clearRect(0,0,this.W,this.H),this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(-.1),this.dibujarArcoInterior(t/1.2),this.dibujarArcoExterior(t/1.2),r>=0)for(n=i+i%2-1,a=n/-2,o=a+i,e=i;e--;)c=Math.max(0,r-e),s=this.bullets[e],s.x=this.r*(1.5-.2*Math.sin(Math.PI/2*Math.abs(s.y)*.3)),s.y=s.order-Math.floor(r),s.opacity=1,.5>c?(s.x+=this.W*(1-Math.min(1,c/.5)),this.giro=Math.PI/-3*c/.5):i>1&&(c-Math.floor(c)>.5&&c-Math.floor(c)<1&&(s.y-=(c-Math.floor(c)-.5)/.5),s.y<a&&(s.y+=i),s.y<a+.5&&(s.opacity=-2*(a-s.y)),s.y>o-.5&&(s.opacity=2*(o-s.y))),s.draw(this.r);return this.dibujarCilindro(),this.ctx.restore(),2.4*t>i+10}}]),e}(u["default"]);i["default"]=h,e.exports=i["default"]},{"./NSDCylinder.js":20}],22:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},c=t("./Screen.js"),u=r(c),h=t("./NSDCylinderSDR2.js"),l=r(h),f=t("./NSDBullet.js"),p=r(f),d=function(t){function e(t){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.cylinder=new l["default"](this.ctx)}return o(e,t),a(e,[{key:"addBullet",value:function(t){var e=new p["default"](this.ctx);this.cylinder.bullets.push(e)}},{key:"draw",value:function(){this.ctx.clearRect(0,0,this.W,this.H),this.cylinder.draw()}}]),e}(u["default"]);i["default"]=d,e.exports=i["default"]},{"./NSDBullet.js":19,"./NSDCylinderSDR2.js":21,"./Screen.js":23}],23:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},s=t("./Element.js"),c=r(s),u=function(t){function e(t){n(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.type="HUD.Screen"}return o(e,t),e}(c["default"]);i["default"]=u,e.exports=i["default"]},{"./Element.js":18}],24:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),c=function(t,e,i){for(var r=!0;r;){var n=t,o=e,a=i;r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;
var c=s.get;if(void 0===c)return;return c.call(a)}var u=Object.getPrototypeOf(n);if(null===u)return;t=u,e=o,i=a,r=!0,s=u=void 0}},u=t("./Element.js"),h=n(u),l=function(t){function e(t,i,r){o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.type="HUD.TextElement",this.text=i||"",this.color="white",this.x=0,this.y=0,this.maxWidth=.9*this.W,this.marginLeft=0,this.font=.06*this.H+"px Calibri",this.color="white",this.lineHeight=.08*this.H,this.typewrite=!1,this.typewLength=0}return a(e,t),s(e,[{key:"draw",value:function(t){this.ctx.save(),this.ctx.globalAlpha=this.opacity,this.ctx.fillStyle=this.color,this.ctx.font=this.font,this.writeLine(this.text,this.marginLeft+this.x,this.y,this.maxWidth),this.ctx.restore()}},{key:"typewriteStep",value:function(t){return t.length>this.typewLength&&(this.typewLength+=1),t.substr(0,this.typewLength)}},{key:"writeLine",value:function(t,e,i,r){t=this.typewrite?this.typewriteStep(t):t;for(var n="",o=this.ctx.measureText(t).width,a=t.split(" "),s=[];o>r;)n=a.pop(),s.unshift(n),t=a.join(" "),o=this.ctx.measureText(t).width;if(!(a.length>0))throw new Error("El texto contiene una palabra más ancha que el ancho máximo del canvas.");this.ctx.fillText(t,e,i),s.length>0&&this.writeLine(s.join(" "),e,i+this.lineHeight,r),n=null,o=null,a=null,s=null}},{key:"draw2",value:function(t){var e=text.substr(this.textAdvance),r=(e.indexOf(" ")+1||text.length+1)-1,n=this.ctx.measureText(e.substring(0,r)).width,o=t.measureText(str.charAt(i)).width;cursorX+n>=canvas.width-padding&&(cursorX=startX,cursorY+=lineHeight),t.fillText(str.charAt(i),cursorX,cursorY),i++,cursorX+=o}}]),e}(h["default"]);r["default"]=l,e.exports=r["default"]},{"./Element.js":18}],25:[function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(i,"__esModule",{value:!0});var n=t("./Coordenada.js"),o=r(n),a=t("./Trayectoria.js"),s=r(a);i["default"]={Position:function(t){var e=t.trial,i=new s["default"]({start:new o["default"](t.position.start||e.mainCamera.position),end:new o["default"](t.position.end||t.position),route:t.position.route||t.route});this.apply=function(t){e.mainCamera.position.copy(i.getVector(t))},t=null},LookAt:function(t){var e=t.trial,i=new s["default"]({start:new o["default"](t.lookat.start||new THREE.Vector3(0,0,-10).applyMatrix4(e.mainCamera.matrixWorld)),end:new o["default"](t.lookat.end||t.lookat),route:t.lookat.route||t.route});this.apply=function(t){e.mainCamera.lookAt(i.getVectorThree(t))},t=null},Up:function(t){var e=t.trial,i=new s["default"]({start:new o["default"](t.up.start||e.mainCamera.up),end:new o["default"](t.up.end||t.up),route:t.up.route||t.route});this.apply=function(t){e.mainCamera.up.copy(i.getVector(t))},t=null},FOV:function(t){var e=t.trial,i=t.fov.start||e.mainCamera.fov,r=(t.fov.end||t.fov)-i;this.apply=function(t){e.mainCamera.fov=i+r*t,e.mainCamera.updateProjectionMatrix()},t=null}},e.exports=i["default"]},{"./Coordenada.js":6,"./Trayectoria.js":12}]},{},[2]);
//# sourceMappingURL=bundle.js.map
